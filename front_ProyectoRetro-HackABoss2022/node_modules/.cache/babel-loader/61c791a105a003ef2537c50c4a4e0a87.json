{"ast":null,"code":"var _jsxFileName = \"/home/pablofdez/Desktop/RETRO_RepositorioMykell/frontProyectoRetro/src/MyActivity/ArticlesBuyer.js\",\n    _s = $RefreshSig$();\n\nimport { useNavigate } from 'react-router-dom';\nimport React, { Suspense, useEffect, useState } from 'react';\nimport './MyActivity.css';\nimport { useSelector } from 'react-redux';\nimport useFetch from \"fetch-suspense\";\nimport Loading from '../Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ArticlesBuyer(_ref) {\n  _s();\n\n  var _datosArticulos$;\n\n  let {\n    setShow\n  } = _ref;\n  const userToken = useSelector(s => s.user);\n  const navigate = useNavigate();\n  const [fecha, setFecha] = useState('');\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    !userToken && navigate('user/registre');\n  }, [userToken, navigate]);\n  const opts = {};\n\n  if (userToken !== null && userToken !== void 0 && userToken.token) {\n    opts.headers = {\n      'Authorization': 'Bearer ' + userToken.token\n    };\n  }\n\n  let datosArticulos;\n  datosArticulos = useFetch('http://localhost:3000/trading/userSeller', opts);\n  if (!(userToken !== null && userToken !== void 0 && userToken.token)) datosArticulos = undefined;\n  const [{\n    username\n  }] = useFetch('http://localhost:3000/users/name/' + datosArticulos[0][0].buyerId);\n  console.log(username);\n\n  const handleSubmit = async (e, _ref2) => {\n    let {\n      idArticle,\n      idBuyer,\n      location,\n      province\n    } = _ref2;\n    setLoading(true);\n    e.preventDefault();\n    const date = new Date(fecha);\n    const date2 = new Date();\n\n    if (date > date2) {\n      const fechaHora = fecha.split('Z')[0].split('T');\n      const accept = {\n        idBuyer: idBuyer,\n        articleId: idArticle,\n        tradingInfo: {\n          buy: 1,\n          salePlace: location + ' ' + province,\n          saleDate: fechaHora[0],\n          saleHour: fechaHora[1] + ':00'\n        }\n      };\n      const res = await fetch('http://localhost:3000/trading/userSeller', {\n        method: 'POST',\n        body: JSON.stringify(accept),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + (userToken === null || userToken === void 0 ? void 0 : userToken.token)\n        }\n      });\n\n      if (res.ok) {\n        window.location.reload(true);\n        setLoading(false);\n      } else {\n        console.log(res);\n        setLoading(false);\n      }\n    } else {\n      alert('fecha incorrecta');\n      setLoading(false);\n    }\n  };\n\n  const handleSubmit2 = async (e, _ref3) => {\n    let {\n      idArticle,\n      idBuyer,\n      location,\n      province\n    } = _ref3;\n    setLoading(true);\n    e.preventDefault();\n    const noAccept = {\n      idBuyer: idBuyer,\n      articleId: idArticle,\n      tradingInfo: {\n        buy: 0,\n        salePlace: location + ' ' + province\n      }\n    };\n    const res = await fetch('http://localhost:3000/trading/userSeller', {\n      method: 'POST',\n      body: JSON.stringify(noAccept),\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + (userToken === null || userToken === void 0 ? void 0 : userToken.token)\n      }\n    });\n\n    if (res.ok) {\n      window.location.reload(true);\n      setLoading(false);\n    } else {\n      console.log(res);\n      setLoading(false);\n    }\n  };\n\n  console.log(datosArticulos[0]);\n  return loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"datauser-activity\",\n    children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 40\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"soldBuy-activity\",\n    children: !datosArticulos[0].length ? /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \"NO TIENES PRODUCTOS EN PROCESON DE VENTA\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this) : (_datosArticulos$ = datosArticulos[0]) === null || _datosArticulos$ === void 0 ? void 0 : _datosArticulos$.map((articulo, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comercio-activity\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"MyArticle-activity\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"image-activity\",\n          src: `http://localhost:3000${articulo.photo.replace('./', '/')}`,\n          alt: articulo.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: articulo.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"textMyArticle-activity\",\n            children: /*#__PURE__*/_jsxDEV(\"h4\", {\n              children: [articulo.price, \" \\u20AC\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 23\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"estado-activity\",\n        children: [datosArticulos[1][i].buy === 1 && articulo.buyerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Estado de la venta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 78\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u2705 Vendido\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 106\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 129\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 72\n        }, this), datosArticulos[1][i].buy === 1 && !articulo.buyerId && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"D\\xEDa de compra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 78\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [datosArticulos[1][i].saleDate.split('Z')[0].split('T')[0], ' ', datosArticulos[1][i].saleDate.split('Z')[0].split('T')[1].slice(0, -4)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 101\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 245\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 73\n        }, this), datosArticulos[1][i].buy === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Estado de la venta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 58\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u274C Rechazado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 86\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 111\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 52\n        }, this), datosArticulos[1][i].buy === null && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Estado de la venta\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: e => handleSubmit(e, {\n              idArticle: articulo.id,\n              idBuyer: datosArticulos[1][i].buyerId,\n              location: articulo.location,\n              province: articulo.province\n            }),\n            children: /*#__PURE__*/_jsxDEV(\"label\", {\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                required: true,\n                type: \"datetime-local\",\n                name: \"horareunion\",\n                onChange: e => setFecha(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                children: \"Poner hora\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: e => handleSubmit2(e, {\n              idArticle: articulo.id,\n              idBuyer: datosArticulos[1][i].buyerId,\n              location: articulo.location,\n              province: articulo.province\n            }),\n            children: /*#__PURE__*/_jsxDEV(\"label\", {\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                children: \"No quiero vender\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 134,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 55\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }, this)]\n    }, articulo.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ArticlesBuyer, \"4dhHzwWqBko424Z7IZN80LDJusk=\", false, function () {\n  return [useSelector, useNavigate, useFetch, useFetch];\n});\n\n_c = ArticlesBuyer;\n\nconst ArticlesBuyerWrapper = () => /*#__PURE__*/_jsxDEV(Suspense, {\n  fallback: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 146,\n    columnNumber: 23\n  }, this),\n  children: /*#__PURE__*/_jsxDEV(ArticlesBuyer, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 146,\n  columnNumber: 3\n}, this);\n\n_c2 = ArticlesBuyerWrapper;\nexport default ArticlesBuyerWrapper;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ArticlesBuyer\");\n$RefreshReg$(_c2, \"ArticlesBuyerWrapper\");","map":{"version":3,"sources":["/home/pablofdez/Desktop/RETRO_RepositorioMykell/frontProyectoRetro/src/MyActivity/ArticlesBuyer.js"],"names":["useNavigate","React","Suspense","useEffect","useState","useSelector","useFetch","Loading","ArticlesBuyer","setShow","userToken","s","user","navigate","fecha","setFecha","loading","setLoading","opts","token","headers","datosArticulos","undefined","username","buyerId","console","log","handleSubmit","e","idArticle","idBuyer","location","province","preventDefault","date","Date","date2","fechaHora","split","accept","articleId","tradingInfo","buy","salePlace","saleDate","saleHour","res","fetch","method","body","JSON","stringify","ok","window","reload","alert","handleSubmit2","noAccept","length","map","articulo","i","photo","replace","name","price","slice","id","target","value","ArticlesBuyerWrapper"],"mappings":"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","sourcesContent":["import { useNavigate } from 'react-router-dom'\nimport React, { Suspense, useEffect, useState } from 'react'\nimport './MyActivity.css'\nimport { useSelector } from 'react-redux'\nimport  useFetch  from \"fetch-suspense\"\nimport Loading from '../Loading'\n\n\n\nfunction ArticlesBuyer({setShow}){\n\n  const userToken = useSelector(s => s.user)\n  const navigate = useNavigate()\n  const [fecha, setFecha] = useState('')\n  const [loading, setLoading] = useState(false)\n  useEffect(() => {\n    !userToken && navigate('user/registre')\n  }, [userToken, navigate])\n\n  const opts = {}\n\n  if (userToken?.token) {\n    opts.headers = { 'Authorization': 'Bearer ' + userToken.token }\n  }\n\n  let datosArticulos\n  datosArticulos = useFetch('http://localhost:3000/trading/userSeller', opts)\n  if (!userToken?.token) datosArticulos = undefined\n\n  const [{username}] = useFetch('http://localhost:3000/users/name/' + datosArticulos[0][0].buyerId)\n  console.log(username)\n\n\n  const handleSubmit = async (e, {idArticle, idBuyer, location, province}) => {\n    setLoading(true)\n    e.preventDefault()\n    const date = new Date(fecha)\n    const date2 = new Date()\n    if (date > date2) {\n      const fechaHora = fecha.split('Z')[0].split('T')\n      const accept = {\n        idBuyer: idBuyer,\n        articleId: idArticle,\n        tradingInfo : {\n            buy : 1,\n            salePlace: location + ' ' + province,\n            saleDate: fechaHora[0],\n            saleHour: fechaHora[1] + ':00'\n        }\n      }\n      const res = await fetch('http://localhost:3000/trading/userSeller', {\n        method: 'POST',\n        body: JSON.stringify(accept),\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + userToken?.token\n        }\n      })\n      if (res.ok) {\n        window.location.reload(true);\n        setLoading(false)\n      } else {\n        console.log(res)\n        setLoading(false)\n      }} else {\n        alert('fecha incorrecta')\n        setLoading(false)\n      }\n  }\n  const handleSubmit2 = async (e, {idArticle, idBuyer, location, province}) => {\n    setLoading(true)\n    e.preventDefault()\n    const noAccept = {\n      idBuyer: idBuyer,\n      articleId: idArticle,\n      tradingInfo : {\n          buy : 0,\n          salePlace: location + ' ' + province,\n      }\n  }\n    const res = await fetch('http://localhost:3000/trading/userSeller', {\n      method: 'POST',\n      body: JSON.stringify(noAccept),\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + userToken?.token\n      }\n    })\n    if (res.ok) {\n      window.location.reload(true);\n      setLoading(false)\n    } else {\n      console.log(res)\n      setLoading(false)\n    }\n  }\n\n  console.log(datosArticulos[0])\n\n  return (\n    loading ?\n    <div className=\"datauser-activity\"><Loading /></div> :\n    <div className='soldBuy-activity'>\n      {\n        !datosArticulos[0].length ?\n        <span>NO TIENES PRODUCTOS EN PROCESON DE VENTA</span>\n        :\n        datosArticulos[0]?.map((articulo, i) =>\n          <div key={articulo.id} className=\"comercio-activity\">\n            <div  className=\"MyArticle-activity\">\n                <img className=\"image-activity\" src={`http://localhost:3000${articulo.photo.replace('./', '/')}`} alt={articulo.name} />\n                <div>\n                  <h3>{articulo.name}</h3>\n                  <div className=\"textMyArticle-activity\">\n                      <h4>{articulo.price} €</h4>\n                  </div>\n                </div>\n            </div>\n            <div className='estado-activity'>\n              {(datosArticulos[1][i].buy === 1) && articulo.buyerId && <div> <h2>Estado de la venta</h2> <span>✅ Vendido</span> <h4>{username}</h4> </div>}\n              {(datosArticulos[1][i].buy === 1) && !articulo.buyerId && <div><h2>Día de compra</h2> <p>{datosArticulos[1][i].saleDate.split('Z')[0].split('T')[0]}{' '}{datosArticulos[1][i].saleDate.split('Z')[0].split('T')[1].slice(0, -4)}</p> <h4>{username}</h4> </div>}\n              {(datosArticulos[1][i].buy === 0) && <div> <h2>Estado de la venta</h2> <span>❌ Rechazado</span> <h4>{username}</h4> </div>}\n              {(datosArticulos[1][i].buy === null) && <div>\n                  <h2>Estado de la venta</h2>\n                  <h4>{username}</h4>\n                  <form onSubmit={(e)=> handleSubmit(e, {idArticle: articulo.id, idBuyer: datosArticulos[1][i].buyerId, location: articulo.location, province: articulo.province})}>\n                    <label>\n                      <input required type=\"datetime-local\" name=\"horareunion\" onChange={(e)=> setFecha(e.target.value)} />\n                      <button>Poner hora</button>\n                    </label>\n                  </form>\n                  <form onSubmit={(e)=> handleSubmit2(e, {idArticle: articulo.id, idBuyer: datosArticulos[1][i].buyerId, location: articulo.location, province: articulo.province})}>\n                    <label>\n                      <button>No quiero vender</button>\n                    </label>\n                  </form>\n                </div>}\n            </div>\n          </div>\n        )}\n    </div>\n  )\n}\n\nconst ArticlesBuyerWrapper = () =>\n  <Suspense fallback={<Loading />}>\n    <ArticlesBuyer />\n  </Suspense>\n\nexport default ArticlesBuyerWrapper\n"]},"metadata":{},"sourceType":"module"}